module.exports = [
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[project]/src/components/ui/sonner.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Toaster",
    ()=>Toaster
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$themes$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-themes/dist/index.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/sonner/dist/index.mjs [app-ssr] (ecmascript)");
"use client";
;
;
;
const Toaster = ({ ...props })=>{
    const { theme = "system" } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$themes$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useTheme"])();
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Toaster"], {
        theme: theme,
        className: "toaster group",
        style: {
            "--normal-bg": "var(--popover)",
            "--normal-text": "var(--popover-foreground)",
            "--normal-border": "var(--border)"
        },
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/sonner.tsx",
        lineNumber: 10,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
;
}),
"[externals]/util [external] (util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/path [external] (path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}),
"[externals]/http [external] (http, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}),
"[externals]/https [external] (https, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}),
"[externals]/url [external] (url, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}),
"[externals]/fs [external] (fs, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}),
"[externals]/crypto [external] (crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}),
"[externals]/assert [external] (assert, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}),
"[externals]/tty [external] (tty, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}),
"[externals]/os [external] (os, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}),
"[externals]/zlib [external] (zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}),
"[externals]/events [external] (events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}),
"[project]/src/config/axios.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/axios/lib/axios.js [app-ssr] (ecmascript)");
;
const API_BASE_URL = ("TURBOPACK compile-time value", "http://localhost:8082/api/v1") || "http://localhost:8082/api/v1";
const apiClient = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].create({
    baseURL: API_BASE_URL,
    timeout: 10000,
    headers: {
        "Content-Type": "application/json"
    }
});
// Request interceptor to add auth token
apiClient.interceptors.request.use((config)=>{
    const token = localStorage.getItem("accessToken");
    if (token) {
        config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
}, (error)=>{
    return Promise.reject(error);
});
// Response interceptor to handle token refresh
apiClient.interceptors.response.use((response)=>response, async (error)=>{
    const originalRequest = error.config;
    if (error.response?.status === 401 && !originalRequest._retry) {
        originalRequest._retry = true;
        try {
            const currentToken = localStorage.getItem("accessToken");
            if (currentToken) {
                console.log("Attempting to refresh token using current access token");
                const response = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post(`${API_BASE_URL}/auth/refresh`, {
                    token: currentToken
                });
                if (response.data.code === 1000 && response.data.result) {
                    const { token: newAccessToken } = response.data.result;
                    localStorage.setItem("accessToken", newAccessToken);
                    // Update the original request with new token
                    originalRequest.headers.Authorization = `Bearer ${newAccessToken}`;
                    return apiClient(originalRequest);
                } else {
                    throw new Error("Refresh failed: Invalid response");
                }
            } else {
                // No token available, redirect to login
                console.log("No access token available, redirecting to login");
                localStorage.removeItem("accessToken");
                localStorage.removeItem("refreshToken");
                window.location.href = "/login";
            }
        } catch (refreshError) {
            console.error("Token refresh failed:", refreshError);
            localStorage.removeItem("accessToken");
            localStorage.removeItem("refreshToken");
            window.location.href = "/login";
        }
    }
    return Promise.reject(error);
});
const __TURBOPACK__default__export__ = apiClient;
}),
"[project]/src/services/api.ts [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "authService",
    ()=>authService,
    "userService",
    ()=>userService,
    "videoService",
    ()=>videoService
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/config/axios.tsx [app-ssr] (ecmascript)");
;
class AuthService {
    async authenticate(request) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post("/auth/token", request);
        return response.data;
    }
    async introspectToken(request) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post("/auth/introspect", request);
        return response.data;
    }
    async refreshToken(refreshToken) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post("/auth/refresh", {
            refreshToken
        });
        return response.data;
    }
    async logout(token) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post("/auth/logout", {
            token
        });
        return response.data;
    }
}
class UserService {
    async getUsers(page = 0, size = 12) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].get(`/users?page=${page}&size=${size}`);
        return response.data;
    }
    async getUserById(userId) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].get(`/users/${userId}`);
        return response.data;
    }
    async updateUser(userId, userData) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].put(`/users/${userId}`, userData);
        return response.data;
    }
    async deleteUser(userId) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].delete(`/users/${userId}`);
        return response.data;
    }
    async registerUser(request) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post("/users", request);
        return response.data;
    }
    async updateUserById(userId, request) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].put(`/users/${userId}`, request);
        return response.data;
    }
}
class VideoService {
    async getVideos(page = 0, size = 10) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].get(`/videos?page=${page}&size=${size}`);
        return response.data;
    }
    async getVideosByUserId(userId, page = 0, size = 10) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].get(`/videos/user/${userId}?page=${page}&size=${size}`);
        return response.data;
    }
    async uploadVideo(file, title, description) {
        const formData = new FormData();
        formData.append("file", file);
        if (title) formData.append("title", title);
        if (description) formData.append("description", description);
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].post("/videos/upload", formData, {
            headers: {
                "Content-Type": "multipart/form-data"
            }
        });
        return response.data;
    }
    async deleteVideo(videoId) {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$config$2f$axios$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"].delete(`/videos/${videoId}`);
        return response.data;
    }
}
const authService = new AuthService();
const userService = new UserService();
const videoService = new VideoService();
}),
"[project]/src/hooks/useAuthStore.ts [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zustand$2f$esm$2f$react$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/zustand/esm/react.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/sonner/dist/index.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$services$2f$api$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/services/api.ts [app-ssr] (ecmascript)");
;
;
;
const useAuthStore = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zustand$2f$esm$2f$react$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["create"])((set, get)=>({
        user: null,
        accessToken: null,
        loading: false,
        isAuthenticated: false,
        refreshToken: null,
        setUser: (user)=>{
            set({
                user
            });
        },
        setRefreshToken: (token)=>{
            set({
                refreshToken: token
            });
        },
        // Set access token and update axios config
        setAccessToken: (token)=>{
            set({
                accessToken: token,
                isAuthenticated: true
            });
        },
        // Clear authentication
        clearAuth: async ()=>{
            set({
                accessToken: null,
                isAuthenticated: false,
                refreshToken: null,
                user: null
            });
        },
        // Login with username/password
        login: async (username, password)=>{
            try {
                console.log("🔐 Login attempt started", {
                    username,
                    passwordLength: password.length,
                    timestamp: new Date().toISOString()
                });
                set({
                    loading: true
                });
                const response = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$services$2f$api$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["authService"].authenticate({
                    username,
                    password
                });
                console.log("🔐 Login API response", {
                    code: response.code,
                    hasToken: !!response.result?.token,
                    tokenPreview: response.result?.token ? `${response.result.token.substring(0, 20)}...` : null,
                    expireAt: response.result?.expireAt,
                    timestamp: new Date().toISOString()
                });
                if (response.code === 1000 && response.result) {
                    const { token } = response.result;
                    set({
                        accessToken: token,
                        isAuthenticated: true,
                        refreshToken: null
                    });
                    localStorage.setItem("accessToken", token);
                    // Note: Backend doesn't provide refresh token, so we don't store one
                    // Don't set user here - let AuthProvider handle it
                    // This ensures the AuthProvider runs its redirect logic
                    console.log("✅ Login successful, token stored. AuthProvider will handle user loading and redirect.", {
                        tokenPreview: `${token.substring(0, 20)}...`,
                        tokenLength: token.length,
                        timestamp: new Date().toISOString()
                    });
                    // Force a small delay to ensure localStorage is updated and AuthProvider can detect the change
                    setTimeout(()=>{
                        console.log("⏰ Login completed, AuthProvider should now detect token and redirect", {
                            localStorageToken: localStorage.getItem("accessToken") ? `${localStorage.getItem("accessToken")?.substring(0, 20)}...` : null,
                            timestamp: new Date().toISOString()
                        });
                        // Trigger a custom event to notify AuthProvider of token change
                        window.dispatchEvent(new CustomEvent("tokenUpdated", {
                            detail: {
                                token: token
                            }
                        }));
                    }, 100);
                    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].success("Login successful!");
                    return true;
                } else {
                    console.error("❌ Login failed:", {
                        code: response.code,
                        message: response.message,
                        timestamp: new Date().toISOString()
                    });
                    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].error(response.message || "Invalid credentials");
                    return false;
                }
            } catch (error) {
                console.error("💥 Login error:", {
                    message: error.message,
                    response: error.response?.data,
                    status: error.response?.status,
                    stack: error.stack,
                    timestamp: new Date().toISOString()
                });
                const errorMessage = error.response?.data?.message || error.message || "Login failed";
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].error(errorMessage);
                return false;
            } finally{
                set({
                    loading: false
                });
            }
        },
        // Logout
        logout: async ()=>{
            try {
                const { accessToken } = get();
                if (accessToken) {
                    await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$services$2f$api$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["authService"].logout(accessToken);
                }
                localStorage.removeItem("accessToken");
                localStorage.removeItem("refreshToken");
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].success("Logged out successfully!");
                get().clearAuth();
            } catch (error) {
                console.error("Logout error:", error);
                __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].error("Logout failed!");
                get().clearAuth();
            }
        }
    }));
const __TURBOPACK__default__export__ = useAuthStore;
}),
"[externals]/next/dist/server/app-render/action-async-storage.external.js [external] (next/dist/server/app-render/action-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/action-async-storage.external.js", () => require("next/dist/server/app-render/action-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[project]/src/hooks/AuthProvider.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>AuthProvider
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$hooks$2f$useAuthStore$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/hooks/useAuthStore.ts [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/navigation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$services$2f$api$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/services/api.ts [app-ssr] (ecmascript)");
"use client";
;
;
;
;
;
function AuthProvider({ children }) {
    const router = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useRouter"])();
    const pathname = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["usePathname"])();
    const { clearAuth, setAccessToken, setUser, user, setRefreshToken } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$hooks$2f$useAuthStore$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"])();
    const [tokens, setTokens] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(null);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useEffect"])(()=>{
        if ("TURBOPACK compile-time falsy", 0) //TURBOPACK unreachable
        ;
    }, [
        setAccessToken,
        setRefreshToken
    ]);
    // Listen for token updates from login store
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useEffect"])(()=>{
        const handleTokenUpdate = (e)=>{
            const newToken = e.detail?.token;
            if (newToken) {
                console.log("🔄 AuthProvider: Token updated via custom event", {
                    newToken: newToken ? `${newToken.substring(0, 20)}...` : null,
                    timestamp: new Date().toISOString()
                });
                setAccessToken(newToken);
                setTokens((prev)=>({
                        accessToken: newToken,
                        refreshToken: prev?.refreshToken || ""
                    }));
            }
        };
        window.addEventListener("tokenUpdated", handleTokenUpdate);
        return ()=>{
            window.removeEventListener("tokenUpdated", handleTokenUpdate);
        };
    }, [
        setAccessToken
    ]);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useEffect"])(()=>{
        console.log("🔐 AuthProvider useEffect triggered", {
            hasToken: !!tokens?.accessToken,
            tokenLength: tokens?.accessToken?.length || 0,
            currentUser: user,
            pathname,
            tokens: tokens ? {
                accessToken: tokens.accessToken ? `${tokens.accessToken.substring(0, 20)}...` : null,
                refreshToken: tokens.refreshToken ? `${tokens.refreshToken.substring(0, 20)}...` : null
            } : null,
            localStorage: {
                accessToken: localStorage.getItem("accessToken") ? `${localStorage.getItem("accessToken")?.substring(0, 20)}...` : null,
                refreshToken: localStorage.getItem("refreshToken") ? `${localStorage.getItem("refreshToken")?.substring(0, 20)}...` : null
            }
        });
        const fetchUser = async ()=>{
            // Don't fetch if user is already loaded or no token
            if (user !== null || !tokens?.accessToken) {
                console.log("⏭️ AuthProvider: Skipping fetchUser", {
                    user: user ? {
                        id: user.id,
                        username: user.username,
                        role: user.role
                    } : null,
                    hasToken: !!tokens?.accessToken,
                    reason: user !== null ? "User already loaded" : "No access token"
                });
                return;
            }
            console.log("🔍 AuthProvider: Starting token validation", {
                hasToken: !!tokens?.accessToken,
                tokenPreview: tokens?.accessToken ? `${tokens.accessToken.substring(0, 20)}...` : null,
                currentUser: user,
                pathname,
                timestamp: new Date().toISOString()
            });
            try {
                // Validate token
                const introspectResponse = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$services$2f$api$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["authService"].introspectToken({
                    token: tokens.accessToken
                });
                console.log("✅ AuthProvider: Token introspection result", {
                    code: introspectResponse.code,
                    isValid: introspectResponse.result?.isValid,
                    userId: introspectResponse.result?.userId,
                    fullResponse: introspectResponse,
                    resultType: typeof introspectResponse.result?.isValid,
                    resultValue: introspectResponse.result?.isValid
                });
                if (introspectResponse.code === 1000 && (introspectResponse.result?.isValid === true || introspectResponse.result?.userId)) {
                    // Get user details using userId from token introspection
                    const userId = introspectResponse.result.userId;
                    if (!userId) {
                        console.log("AuthProvider: No userId in token, clearing auth");
                        localStorage.setItem("accessToken", "");
                        localStorage.setItem("refreshToken", "");
                        clearAuth();
                        if (pathname.startsWith("/admin")) {
                            router.replace("/login");
                        }
                        return;
                    }
                    const userResponse = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$services$2f$api$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["userService"].getUserById(userId);
                    console.log("👤 AuthProvider: User fetch result", {
                        code: userResponse.code,
                        hasUser: !!userResponse.result,
                        userData: userResponse.result ? {
                            id: userResponse.result.id,
                            username: userResponse.result.username,
                            mail: userResponse.result.mail,
                            roles: userResponse.result.roles?.map((r)=>r.name)
                        } : null,
                        fullResponse: userResponse
                    });
                    if (userResponse.code === 1000 && userResponse.result) {
                        const userData = userResponse.result;
                        // Check if user account is enabled
                        if (userData.enable === false) {
                            console.log("🚫 AuthProvider: User account is disabled, clearing auth", {
                                userId: userData.id,
                                username: userData.username,
                                enable: userData.enable,
                                timestamp: new Date().toISOString()
                            });
                            localStorage.setItem("accessToken", "");
                            localStorage.setItem("refreshToken", "");
                            clearAuth();
                            if (pathname.startsWith("/admin")) {
                                router.replace("/login");
                            }
                            return;
                        }
                        const user = {
                            id: userData.id,
                            email: userData.mail,
                            username: userData.username,
                            role: userData.roles?.some((role)=>role.name === "ADMIN") ? "admin" : "moderator",
                            avatar: undefined
                        };
                        setUser(user);
                        console.log("🎉 AuthProvider: User set successfully", {
                            user: {
                                id: user.id,
                                username: user.username,
                                email: user.email,
                                role: user.role
                            },
                            timestamp: new Date().toISOString()
                        });
                        // If on login page and successfully authenticated, redirect to dashboard
                        if (pathname === "/login") {
                            console.log("🚀 AuthProvider: Redirecting from login to dashboard", {
                                from: pathname,
                                to: "/admin/dashboard",
                                timestamp: new Date().toISOString()
                            });
                            router.replace("/admin/dashboard");
                        }
                    } else {
                        // User fetch failed, clear auth
                        console.log("❌ AuthProvider: User fetch failed, clearing auth", {
                            code: userResponse.code,
                            message: userResponse.message,
                            timestamp: new Date().toISOString()
                        });
                        localStorage.setItem("accessToken", "");
                        localStorage.setItem("refreshToken", "");
                        clearAuth();
                        if (pathname.startsWith("/admin")) {
                            router.replace("/login");
                        }
                    }
                } else {
                    // Invalid token, clear auth
                    console.log("🚫 AuthProvider: Invalid token, clearing auth", {
                        code: introspectResponse.code,
                        isValid: introspectResponse.result?.isValid,
                        timestamp: new Date().toISOString()
                    });
                    localStorage.setItem("accessToken", "");
                    localStorage.setItem("refreshToken", "");
                    clearAuth();
                    if (pathname.startsWith("/admin")) {
                        router.replace("/login");
                        return;
                    }
                }
            } catch (error) {
                const errorObj = error;
                console.error("💥 AuthProvider: Auth validation error:", {
                    message: errorObj.message,
                    response: errorObj.response?.data,
                    status: errorObj.response?.status,
                    url: errorObj.config?.url,
                    timestamp: new Date().toISOString(),
                    stack: errorObj.stack
                });
                // Only clear auth and redirect if we're not on the login page
                // This prevents the redirect loop when login is successful
                if (pathname !== "/login") {
                    localStorage.setItem("accessToken", "");
                    localStorage.setItem("refreshToken", "");
                    clearAuth();
                    if (pathname.startsWith("/admin")) {
                        router.replace("/login");
                        return;
                    }
                }
            }
        };
        // Check if we need to redirect from login page when user is already set
        if (user !== null && pathname === "/login") {
            console.log("🔄 AuthProvider: User already set, redirecting from login to dashboard", {
                user: {
                    id: user.id,
                    username: user.username,
                    role: user.role
                },
                from: pathname,
                to: "/admin/dashboard",
                timestamp: new Date().toISOString()
            });
            router.replace("/admin/dashboard");
            return;
        }
        // If user is authenticated and trying to access admin routes, allow it
        if (user !== null && pathname.startsWith("/admin")) {
            console.log("✅ AuthProvider: User authenticated, allowing access to admin routes", {
                user: {
                    id: user.id,
                    username: user.username,
                    role: user.role
                },
                pathname,
                timestamp: new Date().toISOString()
            });
            return;
        }
        // Only run validation if we have a token and no user yet
        if (tokens?.accessToken && user === null) {
            console.log("🔄 AuthProvider: Running fetchUser", {
                hasToken: !!tokens?.accessToken,
                user: user,
                pathname,
                timestamp: new Date().toISOString()
            });
            fetchUser();
        } else if (!tokens?.accessToken && pathname.startsWith("/admin")) {
            // No token and trying to access admin routes
            console.log("🚫 AuthProvider: No token, redirecting to login", {
                hasToken: !!tokens?.accessToken,
                pathname,
                timestamp: new Date().toISOString()
            });
            router.replace("/login");
        }
    }, [
        router,
        pathname,
        clearAuth,
        setAccessToken,
        setUser,
        user,
        tokens,
        setRefreshToken
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Fragment"], {
        children: children
    }, void 0, false);
}
}),
"[project]/src/hooks/QueryProvider.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "QueryProvider",
    ()=>QueryProvider
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$query$2d$core$2f$build$2f$modern$2f$queryClient$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@tanstack/query-core/build/modern/queryClient.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$QueryClientProvider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2d$devtools$2f$build$2f$modern$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@tanstack/react-query-devtools/build/modern/index.js [app-ssr] (ecmascript)");
"use client";
;
;
;
;
function QueryProvider({ children }) {
    const [queryClient] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(()=>new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$query$2d$core$2f$build$2f$modern$2f$queryClient$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["QueryClient"]({
            defaultOptions: {
                queries: {
                    staleTime: 5 * 60 * 1000,
                    retry: 2,
                    refetchOnWindowFocus: false
                },
                mutations: {
                    retry: 1
                }
            }
        }));
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$QueryClientProvider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["QueryClientProvider"], {
        client: queryClient,
        children: [
            children,
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2d$devtools$2f$build$2f$modern$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["ReactQueryDevtools"], {
                initialIsOpen: false
            }, void 0, false, {
                fileName: "[project]/src/hooks/QueryProvider.tsx",
                lineNumber: 27,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/src/hooks/QueryProvider.tsx",
        lineNumber: 25,
        columnNumber: 5
    }, this);
}
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/dynamic-access-async-storage.external.js [external] (next/dist/server/app-render/dynamic-access-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/dynamic-access-async-storage.external.js", () => require("next/dist/server/app-render/dynamic-access-async-storage.external.js"));

module.exports = mod;
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__667ba0da._.js.map